# Nixpacks Configuration for Railway Deployment
# Forces Railway to use our custom build commands instead of auto-detection

providers = ["node"]

[variables]
NODE_VERSION = "20"

[phases.setup]
nixPkgs = ["gcc", "gnumake", "pkg-config", "cairo", "pango", "pixman", "libjpeg", "giflib", "librsvg"]

[phases.install]
cmds = [
  "npm config set legacy-peer-deps true",
  "npm install --no-package-lock",
  "npm rebuild canvas --build-from-source"
]

[phases.build]
cmds = []

[start]
cmd = "npm start"
