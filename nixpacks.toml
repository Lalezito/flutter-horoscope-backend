# Nixpacks Configuration for Railway Deployment
# Let Nixpacks auto-detect Node.js from package.json

[variables]
NODE_VERSION = "20"
NPM_CONFIG_LEGACY_PEER_DEPS = "true"

[phases.setup]
nixPkgs = ["gcc", "gnumake", "pkg-config", "cairo", "pango", "pixman", "libjpeg", "giflib", "librsvg"]

[phases.install]
cmds = [
  "npm install --no-package-lock",
  "npm rebuild canvas --build-from-source || true"
]

[phases.build]
cmds = []

[start]
cmd = "npm start"
