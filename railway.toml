# Railway Configuration for Zodiac Backend
# This ensures proper build with canvas and sharp dependencies

[build]
builder = "NIXPACKS"

[build.nixpacksPlan]
providers = ["nodejs"]

[build.nixpacks.phases.setup]
nixPkgs = ["nodejs", "python3", "pkg-config", "pixman", "cairo", "pango", "libjpeg", "giflib", "librsvg"]

[build.nixpacks.phases.install]
cmds = ["npm install"]

[build.nixpacks.phases.build]
cmds = []

[deploy]
startCommand = "npm run start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[deploy.healthcheckPath]
path = "/health"
